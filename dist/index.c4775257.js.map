{"mappings":"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","sources":["main.js"],"sourcesContent":["(() => {\n    // The width and height of the captured photo. We will set the\n    // width to the value defined here, but the height will be\n    // calculated based on the aspect ratio of the input stream.\n\n    const colorThief = new ColorThief();\n\n    const width = 320; // We will scale the photo width to this\n    let height = 0; // This will be computed based on the input stream\n\n    // |streaming| indicates whether or not we're currently streaming\n    // video from the camera. Obviously, we start at false.\n\n    let streaming = false;\n\n    // The various HTML elements we need to configure or control. These\n    // will be set by the startup() function.\n\n    let video = null;\n    let canvas = null;\n    let photo = null;\n    let colorBox = null;\n    let colorBoxes = null;\n    let boxCountInput = null;\n\n    function createColorBoxes(count = 10) {\n        colorBox.innerHTML = \"\";\n        for (let i = 0; i < count; i++) {\n            const box = document.createElement(\"div\");\n            box.classList.add(\"box\");\n            colorBox.appendChild(box);\n        }\n\n        return document.querySelectorAll(\".box\");\n    }\n\n    function showViewLiveResultButton() {\n        if (window.self !== window.top) {\n            // Ensure that if our document is in a frame, we get the user\n            // to first open it in its own tab or window. Otherwise, it\n            // won't be able to request permission for camera access.\n            document.querySelector(\".contentarea\").remove();\n            const button = document.createElement(\"button\");\n            button.textContent = \"View live result of the example code above\";\n            document.body.append(button);\n            button.addEventListener(\"click\", () => window.open(location.href));\n            return true;\n        }\n        return false;\n    }\n\n    function startup() {\n        if (showViewLiveResultButton()) {\n            return;\n        }\n        video = document.getElementById(\"video\");\n        canvas = document.getElementById(\"canvas\");\n        photo = document.getElementById(\"photo\");\n        colorBox = document.querySelector(\".colorBox\");\n        colorBoxes = createColorBoxes();\n        boxCountInput = document.getElementById(\"boxCount\");\n\n        navigator.mediaDevices\n            .getUserMedia({ video: true, audio: false })\n            .then((stream) => {\n                video.srcObject = stream;\n                video.play();\n            })\n            .catch((err) => {\n                console.error(`An error occurred: ${err}`);\n            });\n\n        video.addEventListener(\n            \"canplay\",\n            (ev) => {\n                if (!streaming) {\n                    height = video.videoHeight / (video.videoWidth / width);\n\n                    // Firefox currently has a bug where the height can't be read from\n                    // the video, so we will make assumptions if this happens.\n\n                    if (isNaN(height)) {\n                        height = width / (4 / 3);\n                    }\n\n                    video.setAttribute(\"width\", width);\n                    video.setAttribute(\"height\", height);\n                    canvas.setAttribute(\"width\", width);\n                    canvas.setAttribute(\"height\", height);\n                    streaming = true;\n                }\n            },\n            false\n        );\n\n        boxCountInput.addEventListener(\"keydown\", (event) => {\n            if (event.key !== \"Enter\") {\n                return;\n            }\n\n            const newCount = event.target.value;\n            if (newCount != colorBox.childElementCount) {\n                colorBoxes = createColorBoxes(newCount);\n            }\n        });\n\n        setInterval(() => {\n            takepicture();\n        }, 1000);\n    }\n\n    function clearphoto() {\n        const context = canvas.getContext(\"2d\");\n        context.fillStyle = \"#AAA\";\n        context.fillRect(0, 0, canvas.width, canvas.height);\n\n        const data = canvas.toDataURL(\"image/png\");\n        photo.setAttribute(\"src\", data);\n    }\n\n    function extendPalette(palette) {\n        const rgbColours = [];\n\n        for (let index = 0; index < colorBoxes.length; index++) {\n            const paletteIndex =\n                index >= palette.length ? index % palette.length : index;\n            const rgbColor = palette[paletteIndex] || [];\n            rgbColours.push(rgbColor);\n        }\n\n        return rgbColours;\n    }\n\n    function shuffle(palette) {\n        for (let i = palette.length - 1; i > 0; i--) {\n            const j = Math.floor(Math.random() * (i + 1));\n            [palette[i], palette[j]] = [palette[j], palette[i]];\n        }\n\n        return palette;\n    }\n\n    function sort(palette) {\n        const rgbToHsl = (c) => {\n            let r = c[0] / 255,\n                g = c[1] / 255,\n                b = c[2] / 255;\n            let max = Math.max(r, g, b),\n                min = Math.min(r, g, b);\n            let h,\n                s,\n                l = (max + min) / 2;\n\n            if (max == min) {\n                h = s = 0; // achromatic\n            } else {\n                let d = max - min;\n                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n                switch (max) {\n                    case r:\n                        h = (g - b) / d + (g < b ? 6 : 0);\n                        break;\n                    case g:\n                        h = (b - r) / d + 2;\n                        break;\n                    case b:\n                        h = (r - g) / d + 4;\n                        break;\n                }\n                h /= 6;\n            }\n            return new Array(h * 360, s * 100, l * 100);\n        };\n\n        return palette\n            .map((c, i) => {\n                return { color: rgbToHsl(c), index: i };\n            })\n            .sort((c1, c2) => {\n                return c1.color[2] - c2.color[2];\n            })\n            .map((data) => {\n                return palette[data.index];\n            });\n    }\n\n    function getDisplayType() {\n        const defaultDisplayType = \"sort\";\n        const displayTypeInput = document.querySelector(\n            'input[name=\"displayType\"]:checked'\n        );\n        const displayType = displayTypeInput\n            ? displayTypeInput.value\n            : defaultDisplayType;\n        return displayType;\n    }\n\n    function drawColours(image) {\n        const palette = colorThief.getPalette(image, colorBoxes.length);\n        const extendedPalette = extendPalette(palette);\n        let rgbColours = [];\n        const displayType = getDisplayType();\n\n        if (displayType === \"sort\") {\n            rgbColours = sort(extendedPalette);\n        } else if (displayType === \"shuffle\") {\n            rgbColours = shuffle(extendedPalette);\n        }\n\n        colorBoxes.forEach((box, index) => {\n            const rgbString = rgbColours[index].join(\", \");\n            box.style.backgroundColor = `rgb(${rgbString})`;\n        });\n    }\n\n    // Capture a photo by fetching the current contents of the video\n    // and drawing it into a canvas, then converting that to a PNG\n    // format data URL. By drawing it on an offscreen canvas and then\n    // drawing that to the screen, we can change its size and/or apply\n    // other changes before drawing it.\n\n    function takepicture() {\n        const context = canvas.getContext(\"2d\");\n        if (width && height) {\n            canvas.width = width;\n            canvas.height = height;\n            context.drawImage(video, 0, 0, width, height);\n\n            const data = canvas.toDataURL(\"image/png\");\n            photo.setAttribute(\"src\", data);\n\n            // Make sure image is finished loading\n            if (photo.complete) {\n                console.log(\"called in complete\");\n                drawColours(photo);\n            } else {\n                photo.addEventListener(\"load\", function () {\n                    drawColours(photo);\n                });\n            }\n        } else {\n            clearphoto();\n        }\n    }\n\n    // Set up our event listener to run the startup process\n    // once loading is complete.\n    window.addEventListener(\"load\", startup, false);\n})();\n"],"names":[],"version":3,"file":"index.c4775257.js.map","sourceRoot":"/__parcel_source_root/"}